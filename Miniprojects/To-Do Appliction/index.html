<!DOCTYPE html>
<html>
<head>
  <title>TO-DO MANAGER</title>
</head>
<body>
  <div class="form-section">
    <label>Date:</label>
    <input type="date" id="date" /><br /><br />

    <label>Enter TO-DO Item Description:</label>
    <input type="text" id="description" /><br /><br />

    <label>Enter Target Date and Time:</label>
    <input type="datetime-local" id="target" /><br /><br />

    <label>Status:</label>
    <select id="status" required>
      <option value="">--Select Status--</option>
      <option value="Not Started">Not Started</option>
      <option value="In Progress">In Progress</option>
      <option value="Completed">Completed</option>
    </select><br /><br />

    <button onclick="addTodo()">SUBMIT</button><br /><br />
  </div>

  <table border="4" id="todoTable">
    <tr>
      <th>TO-DO ID</th>
      <th>TO-DO ITEM</th>
      <th>TARGET DATE TIME</th>
      <th>STATUS</th>
      <th>ACTION</th>
    </tr>
  </table>

  <script>
    let todoId = 1;

    // Set today's date and time as the min value
    function setMinDateTime() {
      const now = new Date();
      const yyyy = now.getFullYear();
      const mm = String(now.getMonth() + 1).padStart(2, '0');
      const dd = String(now.getDate()).padStart(2, '0');
      const hh = String(now.getHours()).padStart(2, '0');
      const min = String(now.getMinutes()).padStart(2, '0');

      const todayDate = `${yyyy}-${mm}-${dd}`;
      const currentDateTime = `${yyyy}-${mm}-${dd}T${hh}:${min}`;

      document.getElementById("date").min = todayDate;
      document.getElementById("target").min = currentDateTime;
    }

    window.onload = setMinDateTime;

    function addTodo() {
      const description = document.getElementById("description").value;
      const target = document.getElementById("target").value;
      const status = document.getElementById("status").value;

      if (!description || !target || !status) {
        alert("Please fill in all fields.");
        return;
      }

      const [datePart, timePart] = target.split("T");
      const [year, month, day] = datePart.split("-");
      const formattedTarget = `${day}-${month}-${year} ${timePart}`;

      const table = document.getElementById("todoTable");
      const newRow = table.insertRow();

      newRow.insertCell(0).innerText = todoId++;
      newRow.insertCell(1).innerText = description;
      newRow.insertCell(2).innerText = formattedTarget;

      const statusCell = newRow.insertCell(3);
      statusCell.innerText = status;

      const actionCell = newRow.insertCell(4);

      // Create dropdown menu for action/status update
      const select = document.createElement("select");

      // Add default option
      const defaultOption = document.createElement("option");
      defaultOption.value = "";
      defaultOption.text = "--Select Status--";
      select.appendChild(defaultOption);

      const statuses = ["Not Started", "In Progress", "Completed"];

      statuses.forEach(st => {
        const option = document.createElement("option");
        option.value = st;
        option.text = st;
        if (st === status) {
          option.selected = true; // preselect current status
        }
        select.appendChild(option);
      });

      // On change, update status cell
      select.onchange = () => {
        if (select.value) {
          statusCell.innerText = select.value;
        }
      };

      actionCell.appendChild(select);

      // Clear input fields after adding
      document.getElementById("description").value = "";
      document.getElementById("target").value = "";
      document.getElementById("status").value = "";

      setMinDateTime(); // refresh min datetime
    }
  </script>
</body>
</html>
